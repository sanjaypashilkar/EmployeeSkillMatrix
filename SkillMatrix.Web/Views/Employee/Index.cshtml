@model List<SkillMatrix.Model.vwEmployee>
@{
    Layout = "_Layout";
}
<form method="post" enctype="multipart/form-data" asp-controller="Employee" asp-action="Index">
    <span>Select File:</span>
    <input type="file" name="file" />
    <input type="submit" class="btn btn-primary" value="Import" />
    <input type="button" class="btn btn-primary" value="Save" id="btnSubmit" />
    <br />
    <span style="color:green">@Html.Raw(ViewBag.Message)</span>
    <input type="hidden" id="fileName" value="@ViewBag.FileName" />
</form>
@if (Model.Count > 0)
{
    <hr />
    <table cellspacing="0" cellpadding="0" border="1" class="table table-striped table-hover table-cards">
        <thead>
            <tr>
                <th>Name</th>
                <th>Date Hired</th>
                <th>Created Date</th>                
            </tr>            
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td> @item.Name</td>
                    <td> @Convert.ToDateTime(item.DateHired).Date.ToShortDateString()</td>
                    <td> @Convert.ToDateTime(item.CreatedDate).Date.ToShortDateString()</td>                    
                </tr>
            }
        </tbody>
    </table>
    <hr />
}

@section Scripts
{
    <script type="text/javascript">
        $(document).ready(function () {
            $("#btnSubmit").click(function () {
                var fileName = $('#fileName').val()
                $.ajax({
                    type: 'POST',
                    dataType: 'JSON',
                    url: '/Employee/SaveEmployees',
                    data: { fileName: $('#fileName').val()},
                    success: function (response) {
                        debugger;
                        alert("Success: " + response);
                    },
                    error: function (response) {
                        debugger;
                        alert("Error: " + response);
                    }
                });
            });
        });
    </script>
}
