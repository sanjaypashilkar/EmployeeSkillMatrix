@model List<SkillMatrix.Model.vwEmployee>
@{
    Layout = "_Layout";
    var counter = 1;
}
<form method="post" enctype="multipart/form-data" asp-controller="Employee" asp-action="Index">
    <div class="card">
        <div class="card-body">
            <div class="d-flex justify-content-center">
                <div class="ml-3"><span>Select File:</span></div>
                <div class="ml-3"><input type="file" name="file" size="50"/></div>
                <div class="ml-3"><input type="submit" class="btn btn-primary btn-sm" value="Import" /></div>
                <div class="ml-3"><input type="button" class="btn btn-primary btn-sm" value="Review & Save" id="btnSave" /></div>
                <div class="ml-3"><input type="button" class="btn btn-primary btn-sm" value="Clear" id="btnClear" /></div>
            </div>
        </div>
        <span style="color:green">@Html.Raw(ViewBag.Message)</span>
        <input type="hidden" id="fileName" value="@ViewBag.FileName" />
    </div>
    @*<span>Select File:</span>
    <input type="file" name="file" />
    <input type="submit" class="btn btn-primary" value="Import" />
    <input type="button" class="btn btn-primary" value="Save" id="btnSubmit" />
    <br />
    <span style="color:green">@Html.Raw(ViewBag.Message)</span>
    <input type="hidden" id="fileName" value="@ViewBag.FileName" />*@
</form>
@if (Model.Count > 0)
{
    <hr />
    <table cellspacing="0" cellpadding="0" border="1" class="table table-striped table-hover table-cards">
        <thead>
            <tr>
                <th>Sr.No</th>
                <th>Name</th>
                <th>Date Hired</th>
                <th>Created Date</th>
            </tr>            
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td> @counter</td>
                    <td> @item.Name</td>
                    <td> @Convert.ToDateTime(item.DateHired).Date.ToShortDateString()</td>
                    <td> @Convert.ToDateTime(item.CreatedDate).Date.ToShortDateString()</td>
                </tr>
                counter++;
       }
        </tbody>
    </table>
    <hr />
}

@section Scripts
{
    <script type="text/javascript">
        $(document).ready(function () {
            $("#btnSave").click(function () {
                var fileName = $('#fileName').val()
                $.ajax({
                    type: 'POST',
                    dataType: 'JSON',
                    url: '/Employee/SaveEmployees',
                    data: { fileName: $('#fileName').val()},
                    success: function (response) {
                        alert("Success: " + response.status);
                        //if (response.success == true) {
                        //    toastr.success("Employees saved successfully", "Success", new { timeout: 300 });
                        //}
                        //else {
                        //    toastr.warning("Employees saved successfully", "Information", new { timeout: 300 });
                        //}
                    },
                    error: function (response) {
                        alert("Error: " + response.status);
                        //toastr.error("There is some problem to process your request", "Error", new { timeout: 300 });
                    }
                });
            });
        });
    </script>
}
