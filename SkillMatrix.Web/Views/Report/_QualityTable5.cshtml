@model SkillMatrix.Model.vwQualityReport
@using SkillMatrix.Model
@{
    var qualitySummary = Model.PaginatedAgentSummaryELSV;
    var counter = 1;

    SkillMatrix.Model.Pager pager = new SkillMatrix.Model.Pager();
    int pageNo = 0;
    if (Model.Pager != null)
    {
        pager = Model.Pager;
        pageNo = pager.CurrentPage;
        counter = pager.RecSkip + 1;
    }
}

@if (qualitySummary.Count > 0)
{
    <Center>
        <div class="d-flex justify-content-center">
            <div class="font-weight-bold">@string.Format("Quality Summary Report", Model.QualityFilter.StartDate.ToShortDateString(), Model.QualityFilter.EndDate.ToShortDateString())</div>
            <div class="ml-3">
                <button id="download" class="btn btn-secondary btn-sm" type="button" onclick="Excel5()" title="Download Report">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z" />
                    </svg>
                </button>
            </div>
        </div>
    </Center>
    await Html.RenderPartialAsync("_Pager", pager);
<div class="table-responsive">    
    <table cellspacing="0" cellpadding="0" border="1" class="table table-striped table-hover table-cards">
        <thead>
            <tr>
                <th rowspan="2">Sr.No</th>
                <th rowspan="2">Month</th>
                <th rowspan="2">Year</th>
                <th rowspan="2">Team Lead</th>
                <th rowspan="2">Agent</th>
                <th rowspan="2">Employee Id</th>
                <th colspan="3">CF1</th>
                <th colspan="3">CF2</th>
                <th colspan="3">CF3</th>
                <th colspan="3">CF4</th>
                <th colspan="2">Customer Focus</th>
                <th colspan="3">SF1</th>
                <th colspan="3">SF2</th>
                <th colspan="3">SF3</th>
                <th colspan="2">System Focus</th>
                <th colspan="3">BP1</th>
                <th colspan="3">BP2</th>
                <th colspan="3">BP3</th>
                <th colspan="2">Business Focus</th>
                <th colspan="3">IC1</th>
                <th colspan="3">IC2</th>
                <th colspan="3">IC3</th>
                <th colspan="3">IC4</th>
                <th colspan="2">Intuitive Customer</th>
                <th rowspan="2">Overall Points Earned</th>
                <th rowspan="2">Overall Total Points</th>
                <th rowspan="2">Overall QC Score</th>
                <th rowspan="2">Passed/Failed</th>
                <th rowspan="2">Passive Survey</th>
                <th rowspan="2">Individual CSAT Score</th>
                <th rowspan="2">No. of People Opportunity</th>
                <th rowspan="2">Flexible QC Type</th>
                <th rowspan="2">No. of Samples</th>
                <th rowspan="2">Remarks</th>
            </tr>
            <tr>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>

                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>

                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>

                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>
                <th>%</th>
                <th>Points Earned</th>
                <th>Total</th>                
            </tr>
        </thead>
        <tbody>
            @foreach (var item in qualitySummary)
            {
            <tr>
                <td> @counter</td>
                <td> @item.Month</td>
                <td> @item.Year</td>
                <td> @item.TeamLead</td>
                <td> @item.AgentName</td>
                <td> @item.EmployeeId</td>
                <td>
                    @if (item.CF1_PointsEarned != 0)
                    {
                        @item.CF1_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.CF1_TotalPoints != 0)
                    {
                        @item.CF1_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.CF1_Percent > 0)
                    {
                        @string.Format("{0}%", item.CF1_Percent);
                    }
                </td>
                <td>
                    @if (item.CF2_PointsEarned != 0)
                    {
                        @item.CF2_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.CF2_TotalPoints != 0)
                    {
                        @item.CF2_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.CF2_Percent > 0)
                    {
                        @string.Format("{0}%", item.CF2_Percent);
                    }
                </td>
                <td>
                    @if (item.CF3_PointsEarned != 0)
                    {
                        @item.CF3_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.CF3_TotalPoints != 0)
                    {
                        @item.CF3_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.CF3_Percent > 0)
                    {
                        @string.Format("{0}%", item.CF3_Percent);
                    }
                </td>
                <td>
                    @if (item.CF4_PointsEarned != 0)
                    {
                        @item.CF4_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.CF4_TotalPoints != 0)
                    {
                        @item.CF4_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.CF4_Percent > 0)
                    {
                        @string.Format("{0}%", item.CF4_Percent);
                    }
                </td>
                <td>
                    @if (item.CF_PointsEarned > 0)
                    {
                        @item.CF_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.CF_TotalPoints > 0)
                    {
                        @item.CF_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.SF1_PointsEarned != 0)
                    {
                        @item.SF1_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.SF1_TotalPoints != 0)
                    {
                        @item.SF1_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.SF1_Percent > 0)
                    {
                        @string.Format("{0}%", item.SF1_Percent);
                    }
                </td>
                <td>
                    @if (item.SF2_PointsEarned != 0)
                    {
                        @item.SF2_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.SF2_TotalPoints != 0)
                    {
                        @item.SF2_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.SF2_Percent > 0)
                    {
                        @string.Format("{0}%", item.SF2_Percent);
                    }
                </td>
                <td>
                    @if (item.SF3_PointsEarned != 0)
                    {
                        @item.SF3_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.SF3_TotalPoints != 0)
                    {
                        @item.SF3_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.SF3_Percent > 0)
                    {
                        @string.Format("{0}%", item.SF3_Percent);
                    }
                </td>
                <td>
                    @if (item.SF_PointsEarned > 0)
                    {
                        @item.SF_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.SF_TotalPoints > 0)
                    {
                        @item.SF_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.BP1_PointsEarned != 0)
                    {
                        @item.BP1_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.BP1_TotalPoints != 0)
                    {
                        @item.BP1_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.BP1_Percent > 0)
                    {
                        @string.Format("{0}%", item.BP1_Percent);
                    }
                </td>
                <td>
                    @if (item.BP2_PointsEarned != 0)
                    {
                        @item.BP2_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.BP2_TotalPoints != 0)
                    {
                        @item.BP2_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.BP2_Percent > 0)
                    {
                        @string.Format("{0}%", item.BP2_Percent);
                    }
                </td>
                <td>
                    @if (item.BP3_PointsEarned != 0)
                    {
                        @item.BP3_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.BP3_TotalPoints != 0)
                    {
                        @item.BP3_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.BP3_Percent > 0)
                    {
                        @string.Format("{0}%", item.BP3_Percent);
                    }
                </td>
                <td>
                    @if (item.BP_PointsEarned > 0)
                    {
                        @item.BP_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.BP_TotalPoints > 0)
                    {
                        @item.BP_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.IC1_PointsEarned != 0)
                    {
                        @item.IC1_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.IC1_TotalPoints != 0)
                    {
                        @item.IC1_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.IC1_Percent > 0)
                    {
                        @string.Format("{0}%", item.IC1_Percent);
                    }
                </td>
                <td>
                    @if (item.IC2_PointsEarned != 0)
                    {
                        @item.IC2_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.IC2_TotalPoints != 0)
                    {
                        @item.IC2_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.IC2_Percent > 0)
                    {
                        @string.Format("{0}%", item.IC2_Percent);
                    }
                </td>
                <td>
                    @if (item.IC3_PointsEarned != 0)
                    {
                        @item.IC3_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.IC3_TotalPoints != 0)
                    {
                        @item.IC3_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.IC3_Percent > 0)
                    {
                        @string.Format("{0}%", item.IC3_Percent);
                    }
                </td>
                <td>
                    @if (item.IC4_PointsEarned != 0)
                    {
                        @item.IC4_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.IC4_TotalPoints != 0)
                    {
                        @item.IC4_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.IC4_Percent > 0)
                    {
                        @string.Format("{0}%", item.IC4_Percent);
                    }
                </td>
                <td>
                    @if (item.IC_PointsEarned > 0)
                    {
                        @item.IC_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.IC_TotalPoints > 0)
                    {
                        @item.IC_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.Overall_PointsEarned > 0)
                    {
                        @item.Overall_PointsEarned;
                    }
                </td>
                <td>
                    @if (item.Overall_TotalPoints > 0)
                    {
                        @item.Overall_TotalPoints;
                    }
                </td>
                <td>
                    @if (item.Overall_QCScore > 0)
                    {
                        @string.Format("{0}%", item.Overall_QCScore);
                    }
                </td>
                <td>
                    @item.PassedOrFailed
                </td>
                <td>
                    @if (item.PassiveSurvey != 0)
                    {
                        @string.Format("{0}%", item.PassiveSurvey);
                    }
                </td>
                <td>
                    @if (item.CSATScore != 0)
                    {
                        @string.Format("{0}%", item.CSATScore);
                    }
                </td>
                <td>
                    @if (item.NoOfPplOpportunity != 0)
                    {
                        @item.NoOfPplOpportunity;
                    }
                </td>
                <td> @item.QCType</td>
                <td> @item.NoOfSamples</td>
                <td> @item.Remarks</td>
            </tr>
                counter++;
            }
        </tbody>
    </table>
</div>
    await Html.RenderPartialAsync("_Pager", pager);
}
else
{
    <Center><b>@string.Format("Information not available")</b></Center>
}