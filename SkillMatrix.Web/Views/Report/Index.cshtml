@model SkillMatrix.Model.vwSkillReport
@{
    Layout = "_Layout";
    var skillMatrix = Model.SkillMatrix;
    var counter = 1;
    <style>
        th[colspan]:not([colspan="1"]) {
            text-align: center;
        }
    </style>
}
<form method="post" enctype="multipart/form-data" asp-controller="Report" asp-action="Index">
    <label>Year: 
        @Html.DropDownListFor(x => x.SkillMatrixFilter.Year, new SelectList(Model.lstYears, "Key", "Value"), new { @class = "myselect" })
    </label>
    <label>Quarter: 
        @Html.DropDownListFor(x => x.SkillMatrixFilter.Quarter, new SelectList(Model.lstQuarters, "Key", "Value"), new { @class = "myselect" })
    </label>
    <label>Team: 
        @Html.DropDownListFor(x => x.SkillMatrixFilter.Team, new SelectList(Model.lstTeams, "Key", "Value"), "-Select Team-", new { @class = "myselect" })
    </label>
    <label>Competency: 
        @Html.DropDownListFor(x => x.SkillMatrixFilter.CompetencyLevel, new SelectList(Model.lstCompetencyLevel, "Key", "Value"), "-Select Competency-", new { @class = "myselect" })
    </label>
    <label>Tenure: 
        @Html.DropDownListFor(x => x.SkillMatrixFilter.TenureLevel, new SelectList(Model.lstTenureLevel, "Key", "Value"), "-Select Tenure-", new { @class = "myselect" })
    </label>
    <br />
    <input type="submit" class="btn btn-primary" value="Filter" />
    <span style="color:green">@Html.Raw(ViewBag.Message)</span>
</form>

@if (skillMatrix.Count > 0)
{
    <hr />
    <Center><b>@string.Format("Skill Matrix {0} Querter {1}", skillMatrix[2].Year, skillMatrix[2].Quarter)</b></Center>
    <table cellspacing="0" cellpadding="0" border="1" class="table table-striped table-hover table-cards">
        <thead>
            <tr>
                <th rowspan="2">Sr.No</th>
                <th rowspan="2">Team</th>
                <th rowspan="2">Name</th>
                <th rowspan="2">Date Hired</th>
                <th rowspan="2">Tenure</th>
                <th rowspan="2">Date Completed</th>
                <th colspan="2">Proficiency Report</th>
                <th colspan="3">Time Spent</th>
                <th colspan="3">Questions Statistics Report</th>
                <th colspan="2">Certification Score</th>
                <th colspan="2">CSAT Score</th>
                <th colspan="2">QC Score</th>
                <th rowspan="2">Overall Score</th>
                <th rowspan="2">Competency Level</th>
                <th rowspan="2">Tenure Level</th>
                <th rowspan="2">Tenure + Competency</th>
            </tr>
            <tr>
                <th>Process Specific</th>
                <th>STAR & OSvC</th>
                <th>Process Specific</th>
                <th>STAR & OSvC</th>
                <th>Total Time Spent</th>
                <th>Process Specific</th>
                <th>STAR & OSvC</th>
                <th>Overall Average</th>
                <th>Certification Score</th>
                <th>Certification Level</th>
                <th>CSAT Score</th>
                <th>CSAT Level</th>
                <th>QC Score</th>
                <th>QC Level</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in skillMatrix)
            {
                <tr>
                    <td> @counter</td>
                    <td> @item.Team</td>
                    <td> @item.Name</td>
                    <td> @Convert.ToDateTime(item.DateHired).Date.ToShortDateString()</td>
                    <td> @string.Format("{0} years {1} months", item.TenureYears, item.TenureMonths)</td>
                    <td> @Convert.ToDateTime(item.DateCompleted).Date.ToShortDateString()</td>
                    <td> @string.Format("{0}%", item.ProcessSpecific_PR)</td>
                    <td> @string.Format("{0}%", item.StarAndOSvC_PR)</td>
                    <td> @item.ProcessSpecific_TS</td>
                    <td> @item.StarAndOSvC_TS</td>
                    <td> @item.TotalTimeSpent</td>
                    <td> @string.Format("{0}%", item.ProcessSpecific_QSR)</td>
                    <td> @string.Format("{0}%", item.StarAndOSvC_QSR)</td>
                    <td> @string.Format("{0}%", item.AvgQuestionsStatisticsReport)</td>
                    <td> @item.CertificationScore</td>
                    <td> @item.CertificationLevel</td>
                    <td> @string.Format("{0}%", item.CSATScore)</td>
                    <td> @item.CSATLevel</td>
                    <td> @string.Format("{0}%", item.QCScore)</td>
                    <td> @item.QCLevel</td>
                    <td> @item.OverallScore</td>
                    <td> @item.CompetencyLevel</td>
                    <td> @item.TenureLevel</td>
                    <td> @item.TenurePlusCompetency</td>
                </tr>
                counter++;
            }
        </tbody>
    </table>
    <hr />
}

@section Scripts
{
    <script type="text/javascript">
        $(document).ready(function () {
            $("#btnSubmit").click(function () {
                var fileName = $('#fileName').val()
                $.ajax({
                    type: 'POST',
                    dataType: 'JSON',
                    url: '/Employee/SaveEmployees',
                    data: { fileName: $('#fileName').val() },
                    success: function (response) {
                        debugger;
                        alert("Success: " + response);
                    },
                    error: function (response) {
                        debugger;
                        alert("Error: " + response);
                    }
                });
            });
        });
    </script>
}
